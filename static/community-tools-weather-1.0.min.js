console.log("Welcome to Yaxham!"),window.yaxham=window.yaxham||{},window.yaxham.modules=window.yaxham.modules||{},function(){function e(e){this.jElement=e,this.initialise()}e.prototype=Object.create(Subscribable.prototype),e.prototype.initialise=function(){this.jElement.html(e.HTML),this.jElement.delegate(".arrow.enabled","click",this.handleClick.bind(this))},e.prototype.handleClick=function(e){var t=jQuery(e.currentTarget);t.hasClass("left")?this.fire("changed",this.selectedIndex-1):this.fire("changed",this.selectedIndex+1)},e.prototype.empty=function(){this.jElement.css("visibility","hidden")},e.prototype.render=function(e,t){this.jElement.css("visibility","visible");var n=e[t].label;this.jElement.find(".value").html(n),this.jElement.find(".left").toggleClass("enabled",t>0),this.jElement.find(".right").toggleClass("enabled",t<e.length-1),this.selectedIndex=t},e.HTML='<div class="hselector"><div class="arrow left">&#8592;</div><div class="value"></div><div class="arrow right">&#8594;</div></div>',window.HSelector=e}(),function(){function e(e,t){this.intervals=[],this.view=e,this.model=t}e.prototype.initialise=function(){this.load(),this.intervals.push(setInterval(this.load.bind(this),3e5)),this.view.updateAll()},e.prototype.load=function(){var t={url:e.URL,dataType:"jsonp"},n=jQuery.ajax(t);n.then(this.handleLoad.bind(this))},e.prototype.handleLoad=function(e){this.model.setAllData(e),this.view.updateAll()},e.prototype.destroy=function(){this.intervals.forEach(function(e){window.clearInterval(e)}),this.view.destroy()},e.URL="http://community-tools.appspot.com/weather",yaxham.modules.WeatherController=e}(),function(){function e(){this.currentIndex=0}e.prototype=Object.create(Subscribable.prototype),e.currentIndex=0,e.direction=null,e.data=null,e.prototype.hasData=function(){return!!this.data},e.prototype.setAllData=function(e){this.data=e;var t=e.SiteRep.DV.Location.Period,n=[];t.forEach(function(e){Array.prototype.push.apply(n,e.Rep)}),this.allPeriods=n},e.prototype.changeCurrentIndex=function(e){this.currentIndex+=e,this.currentIndex=Math.max(0,this.currentIndex),this.currentIndex=Math.min(this.currentIndex,this.allPeriods.length-1),this.fire("indexChanged")},e.prototype.hasPrev=function(){return this.currentIndex>0},e.prototype.hasNext=function(){return this.currentIndex<this.allPeriods.length-1},e.prototype.getForecast=function(){var t=this.currentIndex;return this.allPeriods.map(function(n,r){return{className:r==t?"current":"notCurrent",type:e.WEATHER[n.W].name,icon:e.WEATHER[n.W].img,chanceOfRain:n.Pp,temperature:n.T,windSpeed:n.S,windDirection:n.D,time:e.timeOfReading[n.$]}})},e.prototype.getTemperatureRange=function(){var e=this.allPeriods.map(function(e){return e.T});return{max:Math.max.apply(null,e),min:Math.min.apply(null,e)}},e.timeOfReading={0:"0:00",180:"03:00",360:"06:00",540:"09:00",720:"12:00",900:"15:00",1080:"18:00",1260:"21:00"},e.WEATHER={NA:{name:"Not Available",img:""},0:{name:"Clear",img:"01n.png"},1:{name:"Sunny",img:"01d.png"},2:{name:"Partly cloudy",img:"01n.png"},3:{name:"Partly cloudy",img:"01d.png"},5:{name:"Mist",img:"15.png"},6:{name:"Fog",img:"15.png"},7:{name:"Cloudy",img:"04.png"},8:{name:"Overcast",img:"04.png"},9:{name:"Light rain shower",img:"05n.png"},10:{name:"Light rain shower",img:"05d.png"},11:{name:"Drizzle",img:"09.png"},12:{name:"Light rain",img:"09.png"},13:{name:"Heavy rain shower",img:"10.png"},14:{name:"Heavy rain shower",img:"10.png"},15:{name:"Heavy rain",img:"10.png"},16:{name:"Sleet shower",img:"12.png"},17:{name:"Sleet shower",img:"12.png"},18:{name:"Sleet",img:"12.png"},19:{name:"Hail shower",img:"08d.png"},20:{name:"Hail shower",img:"08n.png"},21:{name:"Hail",img:"08d.png"},22:{name:"Light snow shower",img:"08d.png"},23:{name:"Light snow shower",img:"08n.png"},24:{name:"Light snow",img:"08d.png"},25:{name:"Heavy snow shower",img:"13.png"},26:{name:"Heavy snow shower",img:"13.png"},27:{name:"Heavy snow",img:"13.png"},28:{name:"Thunder shower",img:"11.png"},29:{name:"Thunder shower",img:"11.png"},30:{name:"Thunder",img:"11.png"}},yaxham.modules.WeatherModel=e}(),function(){function e(e,t){this.jElement=jQuery(e);if(this.jElement.length==0)throw new Error("Invalid selector: "+e);this.model=t,this.initialise()}e.prototype=Object.create(Subscribable.prototype),e.prototype.jElement=null,e.prototype.initialise=function(){this.jElement.append(e.MARKUP).delegate(".btn","click.weather",this.handleNavigate.bind(this)),this.model.on("indexChanged",this.updateAll,this)},e.prototype.handleNavigate=function(e){var t=jQuery(e.currentTarget),n=t.data("direction");this.model.changeCurrentIndex(+n)},e.prototype.updateAll=function(){this.model.hasData()?this.displayBoard():this.displayLoading()},e.prototype.displayLoading=function(){this.jElement.find("currentConditions").empty().addClass("loading")},e.prototype.displayBoard=function(){var t=this.model.currentIndex,n=this.model.getForecast(),r=n[t],i=n.filter(function(e,n){return n>=t&&n<t+4});this.jElement.find(".currentConditions").html(Mustache.to_html(e.CURRENT_CONDITIONS,r)),this.jElement.find(".laterConditions").html(Mustache.to_html(e.LATER_CONDITIONS,{forecasts:i}))},e.prototype.destroy=function(){this.jElement.undelegate(".weather"),this.model.un(null,this)},e.CURRENT_CONDITIONS='<img class="icon" src="img/weather/icons_120x100/{{icon}}"/><ul><li><div class="weatherType">{{type}}</div><div class="temperature">{{temperature}}&deg;C</div></li><li class="otherDetails"><div class="heading">Rain</div><div class="rainChance reading">{{chanceOfRain}}%</div><div class="heading">Wind</div><div class="windSpeed reading">{{windSpeed}} mph {{windDirection}}</div></li></ul>',e.LATER_CONDITIONS='{{#forecasts}}<li class="{{className}}"><td><img width="60" height="50" src="/static/img/weather/icons_60x50/{{icon}}" /></td><div class="time heading">{{time}}</div><div class="temperature reading">{{temperature}}&deg;C</div></li>{{/forecasts}}',e.MARKUP='<div class="weather vertical"><div class="currentConditions"></div><div class="navigator"><div class="btn prev" data-direction="-1"></div><ul class="laterConditions"></ul><div class="btn next" data-direction="+1"></div></div><p class="attribution">Data: <a href="http://www.metoffice.gov.uk/public/weather/forecast/dereham">Met Office</a></p></div>',yaxham.modules.WeatherView=e}(),function(){yaxham.modules.Weather=function(e){var t=new yaxham.modules.WeatherModel,n=new yaxham.modules.WeatherChartView(e,t),r=new yaxham.modules.WeatherController(n,t);return r}}(),function(){function e(e,t){this.jElement=jQuery(e);if(this.jElement.length==0)throw new Error("Invalid selector: "+e);this.model=t,this.initialise()}e.prototype=Object.create(Subscribable.prototype),e.prototype.jElement=null,e.prototype.initialise=function(){this.jElement.append(e.MARKUP).delegate(".btn","click.weather",this.handleNavigate.bind(this)),this.weatherChart=new yaxham.modules.WeatherChart(this.jElement.find(".navigator")),this.model.on("indexChanged",this.updateAll,this)},e.prototype.handleNavigate=function(e){var t=jQuery(e.currentTarget),n=t.data("direction");this.model.changeCurrentIndex(+n)},e.prototype.updateAll=function(){this.model.hasData()?this.displayBoard():this.displayLoading()},e.prototype.displayLoading=function(){this.jElement.find("currentConditions").empty().addClass("loading")},e.prototype.displayBoard=function(){var t=this.model.getForecast(),n=this.model.getTemperatureRange(),r=n.max-n.min;t.forEach(function(e){var t=(e.temperature-n.min)/r*50;e.top=50-t}),this.weatherChart.render(t),this.jElement.find(".laterConditions").html(Mustache.to_html(e.LATER_CONDITIONS,{forecasts:t}))},e.prototype.destroy=function(){this.jElement.undelegate(".weather"),this.model.un(null,this)},e.LATER_CONDITIONS='{{#forecasts}}<li><div class="time heading">{{time}}</div><div class="precipitation" style="height: {{chanceOfRain}}px"></div><div class="fc" style="top: {{top}}px"><img width="30" height="25" src="/static/img/weather/icons_60x50/{{icon}}" /><div class="temperature reading">{{temperature}}&deg;C</div></div></li>{{/forecasts}}',e.MARKUP='<div class="weather horizontal"><div class="navigator"><ul class="laterConditions"></ul></div><p class="attribution">Data: <a href="http://www.metoffice.gov.uk/public/weather/forecast/dereham">Met Office</a></p></div>',yaxham.modules.WeatherChartView=e}(),function(e){function t(t){this.jContainer=e(t),this.initialise()}t.prototype.jContainer=null,t.prototype.ctx=null,t.prototype.getCanvas=function(){var e=document.createElement("canvas");return e.width=this.jContainer.width()||160,e.height=this.jContainer.height()||160,this.jContainer[0].appendChild(e),window.G_vmlCanvasManager?window.G_vmlCanvasManager.initElement(e):e},t.prototype.initialise=function(){var e=this.getCanvas();this.ctx=e.getContext("2d")},t.prototype.render=function(e){var n=this.ctx,r=36,i=0;n.clearRect(0,0,500,500),this.setStroke(t.NOTCH),n.beginPath(),n.moveTo(i,e.top+2);for(var s=0;s<20&&s<e.length;s++)n.lineTo(i,e[s].top+2),i+=r;n.stroke()},t.prototype.setStroke=function(e){this.ctx.lineWidth=e["stroke-width"],this.ctx.strokeStyle=e.stroke},t.NOTCH={stroke:"#ccc","stroke-width":2},yaxham.modules.WeatherChart=t}(window.jQuery);